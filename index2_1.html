<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1.3 – Looping Programs</title>
    <script src="./node_modules/p5/lib/p5.min.js"></script>
    <script src="./dist/tg.mjs" type="module"></script>
    <script>
        function preload() {
        }
        
        function setup() {
            createCanvas(500, 500);
            // console.log(t);
            noLoop();
        }
        
        function draw() {
            background(220);
            
            // Figure 2.1
            // random_move(0, 10, 0, 10, 200);
            // random_move(0, 7, -10, 5, 200);
            // random_move(0, 5, -10, 10);
            
            // Figure 2.2
            // random_move_2(0, 10, -10, 10, 500);
            random_move_3(0, 10, -10, 10, 750);
            
            t.turtle();
        }
        
        // p. 56
        function random_move(d1, d2, a1, a2, n=100) {
            t.repeat(n, function() {
               t.left( random(a1, a2) );
               t.forward( random(d1, d2) ); 
            });
        }
        
        // p.57
        let forward_failed = false;
        
        function check_forward(distance) {
            t.push();
            t.penup();
            t.forward(distance);
            forward_failed = out_of_bounds();
            t.pop();
            if (!forward_failed) t.forward(distance);
            
        }
        
        function stuck() {
            return forward_failed;
        }
        
        function out_of_bounds() {
            return abs(t.xcor()) > width/2 || abs(t.ycor()) > height/2;
        }
        
        // p. 58
        function random_move_2(d1, d2, a1, a2, n=100) {
            t.repeat(n, function() {
                t.left( random(a1, a2) );
                check_forward( random(d1, d2) );
                if (stuck()) t.right(180);
            });
        }
        
        // p. 58
        function wriggle() {
            do {
                t.right(1);
                check_forward(1);
            } while (stuck())
        }
        
        function random_move_3(d1, d2, a1, a2, n=100) {
            t.repeat(n, function() {
                t.left( random(a1, a2) );
                check_forward( random(d1, d2) );
                if (stuck()) wriggle();
            });
        }
    </script>
</head>
<body>

</body>
</html>